set daemon 10
   with start delay 15 
set log /home/pi/monit.log

set httpd port 2812 and
   use address localhost  # only accept connection from localhost (drop if you use M/Monit)
   allow localhost        # allow localhost to connect to the server and

check filesystem rootfs with path /
if space usage > 15% then alert
#if space usage > 15% then stop
#if space usage > 15% then unmonitor

check directory ES8 with path /proc/asound/ES8
#if does not exist 
#then exec "/bin/bash -c '2>&1 1>>/home/pi/logster.log /usr/local/bin/LEDhandler.sh sourceUnavailable'"

check program processRawAudio
with path /usr/local/bin/processRawAudio.sh with timeout 10800 s
every 3 cycles
start program = "/bin/bash -c 'sleep 1; /usr/local/bin/processRawAudio.sh'"
if status !=0 then alert
#if status = 0 then alert

check process ffmpegStreamRecorder
with pidfile /home/pi/ffmpeg.pid
depends on ES8
start program = "/bin/bash -c '2>&1 1>>/home/pi/logster.log /usr/local/bin/starter.sh'"
stop program = "/bin/bash -c '2>&1 1>>/home/pi/logster.log /usr/local/bin/stopper.sh'"
if cpu > 15% then alert
if cpu > 20% for 3 cycles then restart
